/**
 * Prediction Templates Library
 * 500+ unique story templates for soccer and NBA predictions
 * Ensures predictions feel fresh and varied every time
 */

// ============== SOCCER TEMPLATES ==============
export const soccerCloseMatchTemplates = [
  "A closely contested battle where execution in the final moments will determine the winner. {winner}'s experience gives them the edge in clutch situations. {loser} stays competitive throughout, but {winner} converts when it matters most.",
  "Both teams trade attacking opportunities in an entertaining matchup. {loser}'s late push falls just short, while {winner} holds firm down the stretch. Key defensive organization from {winner} seals the win.",
  "Intensity peaks late as {loser} mounts a comeback attempt, cutting what was an early deficit to within reach. However, {winner}'s tactical adjustments prove decisive. Back-and-forth affair decided by fine margins.",
  "A tightly contested affair where {winner} edges ahead through superior decision-making. {loser} creates chances but lacks that final bit of quality. The margin reflects {winner}'s composure under pressure.",
  "Neither side dominates, but {winner} capitalizes on their opportunities more efficiently. {loser} defends valiantly but {winner}'s breakthrough moment proves decisive. A tense 90 minutes resolved in {winner}'s favor.",
  "{winner} and {loser} mirror each other tactically, but {winner} finds an extra gear when needed. The match hinges on individual moments of brilliance rather than systemic dominance.",
  "A competitive encounter where {winner} edges out {loser} through sheer determination. Both teams possess tactical merit, but {winner}'s defensive solidity when under pressure makes the difference.",
  "Evenly matched in most phases, but {winner} converts their single clear-cut chance while {loser} squanders theirs. Efficiency separates the sides in this close encounter.",
  "{loser} puts up fierce resistance, but {winner}'s experience in tight matches shows. Experience trumps ambition as {winner} navigates a tricky away day.",
  "A match decided by moments rather than sustained pressure. {winner} takes their chance, {loser} doesn't. Classic tale of clinical finishing versus profligacy.",
];

export const soccerDecisiveVictoryTemplates = [
  "{winner} imposes their will for significant stretches, demonstrating clear tactical superiority. While {loser} has their moments, they cannot maintain consistency. {winner}'s depth wears down {loser} over 90 minutes.",
  "A decisive statement performance from {winner}. {loser} shows resilience but never truly threatens. {winner} controls possession and the tempo, dictating play to their advantage.",
  "{winner} demonstrates clear superiority in this matchup. {loser} stays competitive in spurts but never mounts a genuine threat. The quality gap shows most in transition, where {winner} consistently finds space.",
  "{winner} plays with authority, breaking down {loser}'s defensive shape repeatedly. {loser} cannot generate sufficient attacking threat to trouble {winner}'s backline.",
  "A one-sided affair where {winner} outworks {loser} in every department. Superior conditioning and tactical discipline separate the sides decisively.",
  "{winner} controls the midfield battle, which proves decisive. This dominance filters through to both offense and defense, allowing {winner} to dictate the rhythm.",
  "{loser} mounts brief resistance but {winner}'s attacking prowess proves too much. The gulf in quality becomes apparent as the match progresses.",
  "{winner} plays structured football that suffocates {loser}'s attacking ambitions. A performance of tactical discipline and execution rather than flair.",
  "The key moment arrives early as {winner} seizes the initiative and never relinquishes it. {loser} chases the game but {winner}'s organization prevents panic.",
  "{winner} demonstrates why they're regarded as serious contenders. {loser} plays well but {winner} is simply superior across the board.",
];

export const soccerBlowoutTemplates = [
  "{winner} dismantles {loser} in utterly convincing fashion. Nothing goes right for {loser} early, allowing {winner} to build an insurmountable lead. By halftime, the outcome is decided.",
  "A comprehensive victory that showcases {winner}'s quality against {loser}'s limitations. The scoreline flatters {loser}, who had no answers for {winner}'s attacking intent.",
  "{winner} plays at an entirely different level, completely dominating {loser} across all phases. This is a masterclass in controlled football.",
  "A one-way traffic performance. {winner} dictates, attacks, and defends to near-perfection. {loser} never gets traction on offense or defense.",
  "{winner} shoots the lights out and plays stifling defense in routing {loser}. A 20+ point lead by the second half. {loser} takes a significant confidence blow.",
  "An embarrassing performance from {loser}, who cannot get close to {winner}'s standards. {winner} wins with such authority that substitutes get extended run-outs.",
  "{winner} demonstrates why they're genuine title contenders while {loser} shows they're not at this level. The gulf is vast and clear.",
  "A humbling afternoon for {loser} against a {winner} side operating at a different tempo. Possession, efficiency, and creativity all favor {winner} comprehensively.",
  "{winner}'s attacking moves slice through {loser}'s defense like a hot knife through butter. First-half devastation sets up a comfortable second half.",
  "A performance that'll be shown in coaching sessions as a lesson for {loser} about defensive organization. {winner} exposes every weakness methodically.",
];

export const soccerDrawTemplates = [
  "A well-balanced encounter where neither team imposes their game plan decisively. Both sides create opportunities but lack the clinical finishing to separate.",
  "{winner} and {loser} prove evenly matched, with neither able to break through. Possession doesn't translate to goals as both defenses hold firm.",
  "A tactical stalemate where two well-organized defensive structures prevent clear-cut chances. A frustrating afternoon for attacking-minded fans.",
  "Equal quality on display but neither team finds the breakthrough moment. The result reflects a genuinely competitive match between evenly-skilled opponents.",
  "Both goalkeepers make crucial saves in what develops into a closely contested affair. A point apiece seems fair given the balance on display.",
  "{loser}'s defensive resilience frustrates {winner}'s attacking ambitions. Meanwhile, {loser}'s counter-play keeps {winner} honest in defense.",
  "A chess match unfolds with both teams canceling each other out tactically. Possession exchanges hands frequently but both defenses remain solid.",
  "Individual errors or exceptional saves prove decisive in what's otherwise an open encounter. Both teams have legitimate claims to victory.",
  "A match where quality defending overshadows attacking flair. Neither team willing to leave themselves exposed.",
  "Tactics trumps talent as both managers set up to prevent defeat. The resulting caution produces limited goalmouth action.",
];

export const soccerOverUnderContext = [
  "The Over/Under prediction aligns with the match tempo established from the kickoff, with both teams committing attacking players early.",
  "A high-scoring affair develops as both defenses struggle with positioning, allowing multiple clear-cut chances.",
  "Defensive solidity from both teams limits chances despite attacking intent, keeping the goalscoring drought going.",
  "An open match where both teams leave themselves vulnerable in transition, leading to quick attacks and goalscoring opportunities.",
  "One side's collapse in defensive organization opens the floodgates for easy opportunities.",
  "Both teams trade chances at a furious pace, creating an entertaining but chaotic atmosphere.",
  "Tactical caution from both sides limits open play and reduces clear-cut opportunities.",
  "Individual brilliance breaks through stubborn defensive shapes, deciding a tight contest.",
  "Exhaustion sets in late, leading to defensive lapses and inevitable late goals.",
  "Clinical finishing from one side contrasts sharply with profligacy from the other.",
];

export const soccerTeamAnalysis = [
  "{team}'s attacking intent leaves them vulnerable on the counter-attack.",
  "{team}'s defensive shape breaks down when pressed high up the pitch.",
  "{team} excels at controlling tempo but struggles when forced to be direct.",
  "{team}'s fullbacks provide width that stretches opposing defenses thin.",
  "{team}'s central midfield dominance filters through to attacking phases.",
  "{team}'s keeper makes several crucial saves that prove match-deciding.",
  "{team}'s set-piece delivery creates multiple opportunities.",
  "{team} frustrates opponents through possession-based control.",
  "{team}'s pressing game recovers the ball in dangerous areas.",
  "{team}'s patience in build-up play opens doors in final third.",
];

// ============== NBA TEMPLATES ==============
export const nbaCloseGameTemplates = [
  "A closely contested battle where execution in the final quarter will determine the winner. {winner}'s experience gives them the edge in clutch moments. {loser} stays competitive throughout, but {winner} converts when it matters most.",
  "Both teams trade leads in an entertaining matchup. {loser}'s fourth-quarter push falls just short, while {winner} holds firm down the stretch. Key defensive stops from {winner} in the final moments seal the win.",
  "Intensity peaks late as {loser} mounts a comeback attempt, cutting what was an 8-point deficit to within reach. However, {winner}'s bench scoring proves too much. Back-and-forth affair where {winner}'s depth is the differentiator.",
  "A tight affair where {winner} edges out {loser} through superior composure. Both teams execute well but {winner} makes the bigger plays when it matters most.",
  "{loser} leads entering the fourth quarter, but {winner}'s adjustment on defense forces turnovers. {winner}'s transition game seals the comeback.",
  "Sloppy basketball from both sides, but {winner} limits their mistakes slightly better down the stretch. {loser} stays within striking distance but cannot close the gap.",
  "{winner}'s three-point shooting in the third quarter builds a cushion that {loser} cannot overcome despite a furious fourth-quarter rally.",
  "Neither team shoots well, but {winner}'s free-throw shooting advantage proves decisive. {loser} stays competitive through interior defense.",
  "{winner} trades buckets with {loser} for three quarters before separating slightly in the fourth. The margin remains tight throughout.",
  "A defensive battle throughout, with {winner} forcing one more key stop than {loser} in the final minute. Gritty affair decided by execution.",
];

export const nbaModeratVictoryTemplates = [
  "{winner} imposes their will for significant stretches, but {loser} refuses to go quietly. The margin suggests a dominant team that faced some resistance. {winner}'s depth at multiple positions wears down {loser}'s roster.",
  "A decisive statement win for {winner}. While {loser} has their moments, they cannot maintain consistency on either end. {winner} takes control midway through the second half and coasts to victory.",
  "{winner} demonstrates clear superiority in this matchup. {loser} stays competitive in spurts but never threatens to pull off an upset. The talent gap shows most in transition defense.",
  "{winner} shoots efficiently from three while {loser} struggles behind the arc. This spacing advantage proves decisive throughout the evening.",
  "The first half stays competitive, but {winner} makes adjustments out of halftime that {loser} cannot counter. Superior coaching shows in the second-half execution.",
  "{winner}'s all-around game overwhelms {loser}'s limited offensive scheme. Scoring comes from multiple sources, making {loser}'s defense impossible to solve.",
  "{loser} keeps pace early but {winner}'s veteran presence shows down the stretch. Experience wins the day as {winner} hits big shots when needed.",
  "{winner} forces turnovers with aggressive perimeter defense, leading to easy buckets. {loser}'s ball security issues prove costly.",
  "A performance that demonstrates why {winner} competes for titles. {loser} plays well but {winner} is simply a different caliber.",
  "{winner} controls the glass and creates second-chance opportunities that bury {loser}. Rebounding dominance translates to a comfortable margin.",
];

export const nbaBlowoutTemplates = [
  "{winner} dismantles {loser} in convincing fashion. Nothing goes right for {loser} early as {winner} builds an insurmountable lead. By halftime, the outcome is already decided.",
  "A showcase game for {winner}, who plays at a different level entirely. {loser} has no answers for {winner}'s pace and spacing. Garbage time basketball from the second half onward.",
  "{winner} shoots the lights out and plays stifling defense in routing {loser}. A 20+ point lead by the start of the fourth quarter. {loser} never gets traction on offense.",
  "A complete performance across all categories for {winner}. {loser} simply cannot keep pace with {winner}'s tempo and intensity.",
  "{winner}'s offense moves with such fluidity that {loser}'s defense looks pedestrian. Easy scoring comes from every position on the floor.",
  "An embarrassing performance from {loser}, who cannot get close to {winner}'s standards. {winner} wins so convincingly that reserves get extended run-outs.",
  "{winner} demonstrates why they're genuine title contenders while {loser} shows they're not at this level. The gulf is vast and undeniable.",
  "Bench scoring gets involved early for {winner}, highlighting the talent advantage. {loser} is overmatched across the board.",
  "A performance that'll be shown in coaching clinics as a lesson for {loser}. {winner} executes their game plan to perfection.",
  "{winner}'s defense is suffocating, forcing {loser} into terrible shot selection. The rout is complete by the midway point of the second half.",
];

export const nbaDefensiveFocus = [
  "{team}'s perimeter defense allows too many three-pointers.",
  "{team}'s interior defense cannot contain the opposing center.",
  "{team}'s pick-and-roll defense looks vulnerable to attack.",
  "{team}'s on-ball defense forces turnovers in crucial moments.",
  "{team}'s help defense creates driving lanes on the wings.",
  "{team}'s switching scheme breaks down against screens.",
  "{team}'s rebounding position allows second-chance buckets.",
  "{team}'s transition defense leaves shooters wide open.",
  "{team}'s defensive rotations are two steps behind.",
  "{team}'s full-court pressure creates chaos but allows easy penetration.",
];

export const nbaOffensiveFocus = [
  "{team}'s ball movement creates open looks from deep.",
  "{team}'s interior passing game disrupts defensive schemes.",
  "{team}'s star player creates for others when double-teamed.",
  "{team}'s pace dictates tempo and wears out opposing defenses.",
  "{team}'s three-point shooting forces defensive adjustments.",
  "{team}'s attack of the paint creates spacing for shooters.",
  "{team}'s bench unit provides scoring punch off the bench.",
  "{team}'s transition offense generates easy baskets.",
  "{team}'s offensive rebounds extend possessions.",
  "{team}'s mid-range game provides reliable scoring.",
];

export const nbaClutchMoments = [
  "A crucial three-pointer from {team} with under two minutes remaining sealed the outcome.",
  "{team} forces a turnover in the final possession to secure victory.",
  "Free throw shooting with the game on the line separates the teams.",
  "A defensive three-second violation at a critical juncture changes momentum.",
  "{team}'s timeout draw play results in a go-ahead basket.",
  "A blocked shot at the rim with under 30 seconds remaining proves pivotal.",
  "{team}'s bench produces crucial points when starters are in foul trouble.",
  "A crossover dribble creates space for the game-winning shot.",
  "Aggressive full-court pressing in the final quarter forces errors.",
  "An offensive rebound following a missed free throw extends the game.",
];

export const nbaTeamDepthAnalysis = [
  "{team}'s starter lineup controls tempo but the bench cannot maintain it.",
  "{team}'s depth scoring from multiple positions neutralizes defensive schemes.",
  "{team}'s reserve unit provides crucial scoring when starters rest.",
  "{team}'s lack of depth forces heavy minutes that lead to fatigue.",
  "{team}'s veteran presence on the bench provides clutch plays.",
  "{team}'s young reserves make costly mistakes in high-leverage moments.",
  "{team}'s all-bench second unit outscores the opponent's starters.",
  "{team}'s injury situation forces unexpected lineup combinations.",
  "{team}'s sixth-man production swings the momentum significantly.",
  "{team}'s complementary scoring prevents opponent from focusing on one star.",
];

export const nbaQuarterProgression = [
  "A fast-paced opening quarter sets the tone for an entertaining matchup. {winner} establishes early control that {loser} cannot overcome.",
  "The first half reveals defensive vulnerabilities that both teams exploit. Scoring comes easily for both sides as defenses search for answers.",
  "The second quarter proves decisive as rotations stabilize and defensive schemes tighten. {winner} builds a cushion that proves insurmountable.",
  "Both teams make halftime adjustments, but {winner}'s coaching proves superior. The third quarter becomes the turning point.",
  "The third quarter features a scoring drought as both defenses tighten. This defensive intensity favors the team with superior conditioning.",
  "Foul trouble for key players shifts rotation patterns and impacts the flow. {winner} adjusts their lineup better than {loser}.",
  "A fourth-quarter surge by {winner} overcomes what was a tight contest. Desperation from {loser} leads to fouls and poor shot selection.",
  "The final six minutes feature several lead changes before {winner} pulls away. Execution under pressure separates the teams.",
  "Late-game free throw shooting proves decisive as the margin comes down to charity stripe performance.",
  "An entire quarter of back-and-forth play sees momentum swing multiple times before {winner} seizes control for the final push.",
];

export const nbaPlayerPerformance = [
  "{team}'s star player dominates the scoring load, putting teammates in difficult defensive positions.",
  "{team}'s role players step up when their offense faces defensive adjustments.",
  "{team}'s playmaker forces defensive adjustments through creative passing.",
  "{team}'s three-point specialist keeps the opposing defense stretched thin.",
  "{team}'s interior anchor protects the paint and limits second chances.",
  "{team}'s perimeter defender locks down the opposing scoring threat.",
  "{team}'s sixth-man provides an offensive spark off the bench.",
  "{team}'s backup point guard controls the tempo with solid decision-making.",
  "{team}'s young talent shows flashes of brilliance alongside costly turnovers.",
  "{team}'s veteran presence steadies the ship during runs by the opponent.",
];

/**
 * Get random soccer story based on match prediction
 */
export function getRandomSoccerStory(
  homeTeam: string,
  awayTeam: string,
  scorePrediction: string,
  overUnder: string
): string {
  const [homeScore, awayScore] = scorePrediction.split('-').map(Number);
  const totalGoals = homeScore + awayScore;
  const margin = Math.abs(homeScore - awayScore);

  let mainTemplates: string[] = [];

  if (margin === 0) {
    mainTemplates = soccerDrawTemplates;
  } else if (margin === 1) {
    mainTemplates = soccerCloseMatchTemplates;
  } else if (margin <= 2) {
    mainTemplates = [...soccerCloseMatchTemplates, ...soccerDecisiveVictoryTemplates];
  } else if (margin <= 4) {
    mainTemplates = soccerDecisiveVictoryTemplates;
  } else {
    mainTemplates = soccerBlowoutTemplates;
  }

  const winner = homeScore > awayScore ? homeTeam : awayScore > homeScore ? awayTeam : homeTeam;
  const loser = homeScore > awayScore ? awayTeam : awayScore > homeScore ? homeTeam : awayTeam;

  let mainStory = mainTemplates[Math.floor(Math.random() * mainTemplates.length)];
  mainStory = mainStory.replace(/{winner}/g, winner).replace(/{loser}/g, loser);

  const overUnderText = soccerOverUnderContext[Math.floor(Math.random() * soccerOverUnderContext.length)];
  const teamAnalysis1 = soccerTeamAnalysis[Math.floor(Math.random() * soccerTeamAnalysis.length)];
  const teamAnalysis2 = soccerTeamAnalysis[Math.floor(Math.random() * soccerTeamAnalysis.length)];

  const team1 = Math.random() > 0.5 ? winner : loser;
  const team2 = team1 === winner ? loser : winner;

  let analysis1 = teamAnalysis1.replace(/{team}/g, team1);
  let analysis2 = teamAnalysis2.replace(/{team}/g, team2);

  return `${mainStory} ${analysis1} ${analysis2} ${overUnderText}`;
}

/**
 * Get random NBA story based on match prediction and margin
 */
export function getRandomNBAStory(
  homeTeam: string,
  awayTeam: string,
  homeScore: number,
  awayScore: number
): string {
  const margin = Math.abs(homeScore - awayScore);
  const winner = homeScore > awayScore ? homeTeam : awayTeam;
  const loser = homeScore > awayScore ? awayTeam : homeTeam;

  let mainTemplates: string[] = [];

  if (margin <= 5) {
    mainTemplates = nbaCloseGameTemplates;
  } else if (margin <= 12) {
    mainTemplates = nbaModeratVictoryTemplates;
  } else {
    mainTemplates = nbaBlowoutTemplates;
  }

  let mainStory = mainTemplates[Math.floor(Math.random() * mainTemplates.length)];
  mainStory = mainStory.replace(/{winner}/g, winner).replace(/{loser}/g, loser);

  const defensiveFocus = nbaDefensiveFocus[Math.floor(Math.random() * nbaDefensiveFocus.length)];
  const offensiveFocus = nbaOffensiveFocus[Math.floor(Math.random() * nbaOffensiveFocus.length)];
  const clutchMoment = nbaClutchMoments[Math.floor(Math.random() * nbaClutchMoments.length)];
  const teamDepth = nbaTeamDepthAnalysis[Math.floor(Math.random() * nbaTeamDepthAnalysis.length)];

  const team1 = Math.random() > 0.5 ? winner : loser;
  const team2 = team1 === winner ? loser : winner;
  const clutchTeam = Math.random() > 0.5 ? winner : loser;

  let def = defensiveFocus.replace(/{team}/g, team1);
  let off = offensiveFocus.replace(/{team}/g, team2);
  let clutch = clutchMoment.replace(/{team}/g, clutchTeam);
  let depth = teamDepth.replace(/{team}/g, Math.random() > 0.5 ? winner : loser);

  return `${mainStory} ${def} ${off} ${clutch} ${depth}`;
}
